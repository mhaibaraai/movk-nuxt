---
title: String
description: String 字段类型的使用方法和配置选项
---

## 基础用法

::note{to="https://zod.dev/api#strings"}
使用 `afz.string()` 创建字符串字段：
::

::component-example
---
name: 'auto-form-field-string-example'
prettier: false
collapse: true
props:
  class: 'px-4'
---
::

## 字符串类型

::note{to="https://zod.dev/api#string-formats"}
Zod v4 提供了专用的字符串验证方法：
::

::code-group
```ts [Email]
const schema = afz.object({
  email: afz.email('请输入有效的邮箱地址')
    .meta({
      label: '邮箱',
      placeholder: 'example@email.com'
    })
})
```

```ts [URL]
const schema = afz.object({
  website: afz.url('请输入有效的 URL')
    .meta({
      label: '网站',
      placeholder: 'https://example.com'
    })
})
```

```ts [UUID]
const schema = afz.object({
  userId: afz.uuid('请输入有效的 UUID')
    .meta({
      label: '用户 ID'
    })
})
```
::

::warning
**Zod v4 迁移提示**

Zod v4 移除了 `z.string().email()` 等方法，改为专用函数：

```ts
// ❌ Zod v3 写法（已废弃）
z.string().email()

// ✅ Zod v4 正确写法
afz.email()
```
::

## 验证规则

```ts
const schema = afz.object({
  // 长度验证
  username: afz.string().min(3).max(20),
  code: afz.string().length(6, '验证码必须是 6 位'),

  // 正则表达式
  phone: afz.string().regex(/^1[3-9]\d{9}$/, '请输入有效的手机号'),

  // 格式转换
  email: afz.email().trim().toLowerCase(),

  // 自定义验证
  password: afz.string()
    .min(8)
    .refine((val) => /[A-Z]/.test(val), '必须包含至少一个大写字母')
    .refine((val) => /[0-9]/.test(val), '必须包含至少一个数字')
})
```

## Examples

::component-example
---
name: 'auto-form-field-string-type-example'
prettier: false
collapse: true
props:
  class: 'px-4'
options:
  - name: 'type'
    label: 'type'
    items:
      - 'string'
      - 'textarea'
      - 'withPasswordToggle'
      - 'withClear'
      - 'withCopy'
      - 'withCharacterLimit'
    default: 'withCharacterLimit'
  - name: 'color',
    items:
      - 'error'
      - 'primary'
      - 'secondary'
      - 'success'
      - 'info'
      - 'warning'
      - 'neutral'
    default: 'primary'
  - name: 'size'
    label: 'size'
    items:
      - 'sm'
      - 'xs'
      - 'md'
      - 'lg'
      - 'xl'
    default: 'sm'
  - name: 'rows'
    label: 'rows'
    default: 5
  - name: 'maxLength'
    label: 'maxLength'
    default: 20
---
::

## 最佳实践

**使用专用类型代替正则验证**

```ts
// ✅ 推荐
afz.email('请输入有效的邮箱地址')

// ❌ 不推荐
afz.string().regex(/^[^\s@]+@[^\s@]+\.[^\s@]+$/, '请输入有效的邮箱地址')
```

**提供清晰的错误提示**

```ts
// ✅ 推荐
afz.string().min(8, '密码至少需要 8 个字符')

// ❌ 不推荐
afz.string().min(8)
```

**合理组合验证规则**

```ts
afz.string()
  .trim()           // 先去除空格
  .toLowerCase()    // 转为小写
  .min(3)           // 再验证长度
  .regex(/^[a-z0-9_]+$/, '只能包含字母、数字和下划线')
```

## 常见问题

### 如何实现异步验证？

使用 `.refine()` 方法配合异步函数：

```ts
const schema = afz.object({
  username: afz.string()
    .min(3)
    .refine(
      async (username) => {
        const response = await $fetch('/api/check-username', {
          query: { username }
        })
        return response.available
      },
      '该用户名已被使用'
    )
})
```

### 如何设置输入框图标？

使用 `controlProps` 配置：

```ts
const schema = afz.object({
  email: afz.email().meta({
    controlProps: {
      leadingIcon: 'i-lucide-at-sign',
      trailingIcon: 'i-lucide-check'
    }
  })
})
```
